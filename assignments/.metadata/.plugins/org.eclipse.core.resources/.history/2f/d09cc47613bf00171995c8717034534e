package com.revature.BankingSystem.BankingUI;

import java.util.ArrayList;

import com.revature.BankingSystem.BankClasses.*;


public class UserLogin extends UIElement {
	
	private ArrayList<User> userList;
	private User userEntering;
	
	public UserLogin() {
		super();
	}
	
	public User login(ArrayList<User> uList) {
		
		userList = uList;
		
		boolean cancel;
		do {
			cancel = false;
			boolean displayFlag = true;
			String uName = null;
			do {
				System.out.print("Enter Username (Enter 0 to create new user): ");
				uName = getUIn().getString();
				if(usernameValidation(uName)) {
					displayFlag = false;
				}else if(uName.equals("-1")){
					newUser();
				}
				else {
					System.out.print("Invalid Username\n");
				}
			}while(displayFlag);
			
			displayFlag = true;
			String uPassword = null;
			do {
				System.out.print("Enter 0 to cancel login\nEnter Password: ");
				uPassword = getUIn().getString();
				if(uPassword.equals("0")) {
					displayFlag = false;
					cancel = true;
				}else if(passwordValidation(uPassword)) {
					displayFlag = false;
				}else {
					System.out.print("Invalid Username/Password Combonation\n");
				}
			}while(displayFlag);
		}while(cancel);
		
		return userEntering;
		
	}
	
	public boolean usernameValidation(String uName) {
		for(User ele : userList) {
			if(ele.getUserName().equals(uName)) {
				userEntering = ele;
				return true;
			}
		}
		return false;
	}
	public boolean passwordValidation(String uPassword) {
		return userEntering.getPassword().equals(uPassword);
	}
	public void newUser() {
		System.out.print("Enter Username: ");
		String userName = "-1";
		do {
			userName = getUIn().getString();
			if(userName.equals("-1")) {
				System.out.println("username cannot be -1");
			}else if(usernameValidation(userName)) {
				System.out.println("username not available");
			}
		}while(!userName.equals("-1") && !usernameValidation(userName));
		System.out.print("Enter First Name: ");
		String firstName =  getUIn().getString();
		System.out.print("Enter Last Name: ");
		String lastName =  getUIn().getString();
		System.out.print("Enter Password: ");
		String password =   getUIn().getString();
	
		RegularUser nUser = new RegularUser(userName, firstName, lastName, password);
		System.out.println("User: "+ nUser + " created.");
		userList.add(nUser);
	}
	
}
